<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Ads Campaign Builder | ROK Systems</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/checkbox-style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Google Ads Campaign Builder</h1>
            <p class="subtitle">Create campaigns, ad groups, and asset groups</p>
        </header>

        <div class="form-container">
            <form id="campaignForm">

                <!-- Step 1: Select Client -->
                <div class="form-section" id="step1">
                    <h2>Step 1: Select Client</h2>
                    <div class="form-group">
                        <label for="client">Client:</label>
                        <select id="client" name="client" required>
                            <option value="">-- Select Client --</option>
                            {% for client in clients %}
                            <option value="{{ client }}">{{ client }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <!-- Step 2: Select Campaign Type -->
                <div class="form-section hidden" id="step2">
                    <h2>Step 2: Campaign Type</h2>
                    <div class="form-group">
                        <label>Campaign Type:</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="campaign_type" value="PERFORMANCE_MAX" required>
                                <span>Performance Max</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="campaign_type" value="SEARCH">
                                <span>Search</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Step 3: New or Existing Campaign -->
                <div class="form-section hidden" id="step3">
                    <h2>Step 3: New or Existing Campaign?</h2>
                    <div class="form-group">
                        <label>Action:</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="action" value="new_campaign" required>
                                <span>Create New Campaign</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="action" value="existing_campaign">
                                <span id="existingCampaignLabel">Add to Existing Campaign</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Step 4a: Select Existing Campaign (if applicable) -->
                <div class="form-section hidden" id="step4a">
                    <h2>Step 4: Select Campaign</h2>
                    <div class="form-group">
                        <label for="existing_campaign">Campaign:</label>
                        <select id="existing_campaign" name="existing_campaign">
                            <option value="">-- Loading campaigns... --</option>
                        </select>
                    </div>

                    <!-- For existing campaign: what to add? -->
                    <div class="form-group" id="existing_campaign_action">
                        <label>What to create:</label>
                        <div class="radio-group">
                            <label class="radio-option" id="option_ad_group">
                                <input type="radio" name="create_type" value="ad_group">
                                <span>New Ad Group</span>
                            </label>
                            <label class="radio-option" id="option_asset_group">
                                <input type="radio" name="create_type" value="asset_group">
                                <span>New Asset Group</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Step 4b: New Campaign Details -->
                <div class="form-section hidden" id="step4b_campaign">
                    <h2>Step 4: Campaign Details</h2>

                    <div class="form-group">
                        <label for="campaign_name">Campaign Name:</label>
                        <input type="text" id="campaign_name" name="campaign_name" placeholder="e.g., Brand | UK | Search | Main">
                        <small>Use ROK naming convention: Brand | Country | Type | Descriptor</small>
                    </div>

                    <div class="form-group">
                        <label for="daily_budget">Daily Budget (¬£):</label>
                        <input type="number" id="daily_budget" name="daily_budget" step="0.01" min="0" placeholder="100.00">
                        <small>Enter budget in pounds (e.g., 100 for ¬£100/day)</small>
                    </div>

                    <div class="form-group">
                        <label>Bidding Strategy:</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="bidding_strategy" value="target_roas">
                                <span>Target ROAS</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="bidding_strategy" value="target_cpa">
                                <span>Target CPA</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group hidden" id="target_roas_field">
                        <label for="target_roas">Target ROAS (%):</label>
                        <input type="number" id="target_roas" name="target_roas" step="0.01" min="0" placeholder="400">
                        <small>Enter as percentage (e.g., 400 for 400% ROAS)</small>
                    </div>

                    <div class="form-group hidden" id="target_cpa_field">
                        <label for="target_cpa">Target CPA (¬£):</label>
                        <input type="number" id="target_cpa" name="target_cpa" step="0.01" min="0" placeholder="10.00">
                        <small>Enter cost per conversion target in pounds</small>
                    </div>

                    <div class="form-group">
                        <label for="locations">Locations:</label>
                        <input type="text" id="locations" name="locations" value="geoTargetConstants/2826" placeholder="geoTargetConstants/2826">
                        <small>Default: UK (geoTargetConstants/2826)</small>
                    </div>
                </div>

                <!-- Step 4b: New Ad Group Details (Search) -->
                <div class="form-section hidden" id="step4b_adgroup">
                    <h2>Step 4: Ad Group Details</h2>

                    <div class="form-group">
                        <label for="ad_group_name">Ad Group Name:</label>
                        <input type="text" id="ad_group_name" name="ad_group_name" placeholder="e.g., Brand Keywords">
                    </div>

                    <div class="form-group">
                        <label for="cpc_bid">Max CPC Bid (¬£):</label>
                        <input type="number" id="cpc_bid" name="cpc_bid" step="0.01" min="0" placeholder="2.00">
                        <small>Optional for Smart Bidding campaigns</small>
                    </div>
                </div>

                <!-- Step 5: What to Add to Ad Group -->
                <div class="form-section hidden" id="step5_adgroup_additions">
                    <h2>Step 5: What to Add?</h2>
                    <small style="color: var(--text-secondary); display: block; margin-bottom: 12px;">
                        Select what you'd like to create (ad group will be created first)
                    </small>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="add_keywords" name="add_keywords">
                            <span>Keywords</span>
                        </label>

                        <label class="checkbox-label">
                            <input type="checkbox" id="add_rsas" name="add_rsas">
                            <span>Responsive Search Ads</span>
                        </label>

                        <label class="checkbox-label">
                            <input type="checkbox" id="add_sitelinks_adgroup" name="add_sitelinks_adgroup">
                            <span>Sitelinks (campaign-level)</span>
                        </label>

                        <label class="checkbox-label">
                            <input type="checkbox" id="add_callouts_adgroup" name="add_callouts_adgroup">
                            <span>Callouts (campaign-level)</span>
                        </label>
                    </div>
                </div>

                <!-- Step 5b: What to Add to New Campaign -->
                <div class="form-section hidden" id="step5_campaign_additions">
                    <h2>Step 5: What to Add to This Campaign?</h2>
                    <small style="color: var(--text-secondary); display: block; margin-bottom: 12px;">
                        Select what you'd like to create (campaign will be created first)
                    </small>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="add_sitelinks_campaign" name="add_sitelinks_campaign">
                            <span>Sitelinks</span>
                        </label>

                        <label class="checkbox-label">
                            <input type="checkbox" id="add_callouts_campaign" name="add_callouts_campaign">
                            <span>Callouts</span>
                        </label>
                    </div>
                </div>

                <!-- Step 5c: What to Add to Asset Group -->
                <div class="form-section hidden" id="step5_assetgroup_additions">
                    <h2>Step 5: What to Add to This Campaign?</h2>
                    <small style="color: var(--text-secondary); display: block; margin-bottom: 12px;">
                        Select what you'd like to create (asset group will be created first)
                    </small>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="add_sitelinks_assetgroup" name="add_sitelinks_assetgroup">
                            <span>Sitelinks (campaign-level)</span>
                        </label>

                        <label class="checkbox-label">
                            <input type="checkbox" id="add_callouts_assetgroup" name="add_callouts_assetgroup">
                            <span>Callouts (campaign-level)</span>
                        </label>
                    </div>
                </div>

                <!-- Step 6a: Keywords Form -->
                <div class="form-section hidden" id="step6a_keywords">
                    <h2>Keywords</h2>

                    <div class="form-group">
                        <label for="keywords_url">Landing Page URL:</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="url" id="keywords_url" name="keywords_url" placeholder="https://example.com/products/diaries" style="flex: 1;">
                            <button type="button" class="btn-secondary" id="generateKeywordsBtn" style="min-width: 150px;">
                                ü§ñ Generate Keywords
                            </button>
                        </div>
                        <small>AI will analyze this page and suggest high-converting keywords</small>
                    </div>

                    <div class="form-group">
                        <label for="keywords">Keywords (one per line):</label>
                        <textarea id="keywords" name="keywords" rows="8" placeholder="leather diary | EXACT&#10;premium notebook | BROAD"></textarea>
                        <small>Format: keyword | match type (EXACT, PHRASE, BROAD)</small>
                        <small style="display: block; margin-top: 5px;">Or use "Generate Keywords" button above</small>
                    </div>
                </div>

                <!-- Step 6b: Responsive Search Ads Form -->
                <div class="form-section hidden" id="step6b_rsas">
                    <h2>Responsive Search Ads</h2>

                    <div class="form-group">
                        <label for="rsa_final_url">Final URL:</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="url" id="rsa_final_url" name="rsa_final_url" placeholder="https://example.com/products" style="flex: 1;">
                            <button type="button" class="btn-secondary" id="generateRsaBtn" style="min-width: 150px;">
                                ü§ñ Generate Ad Copy
                            </button>
                        </div>
                        <small>AI will analyze this page and generate professional ad copy</small>
                    </div>

                    <div class="form-group">
                        <label for="rsa_headlines">Headlines (one per line, 3-15 required):</label>
                        <textarea id="rsa_headlines" name="rsa_headlines" rows="6" placeholder="Luxury leather diaries&#10;Handcrafted in London&#10;Free UK delivery"></textarea>
                        <small>Max 30 characters each, 3-15 headlines required</small>
                        <small style="display: block; margin-top: 5px;">Or use "Generate Ad Copy" button above</small>
                    </div>

                    <div class="form-group">
                        <label for="rsa_descriptions">Descriptions (one per line, 2-4 required):</label>
                        <textarea id="rsa_descriptions" name="rsa_descriptions" rows="4" placeholder="Discover luxury leather gifts - perfect for the festive season&#10;Elegant leather gifts, expertly crafted"></textarea>
                        <small>Max 90 characters each, 2-4 descriptions required</small>
                    </div>

                    <div class="form-group" style="display: flex; gap: 15px;">
                        <div style="flex: 1;">
                            <label for="rsa_path1">Path 1 (optional):</label>
                            <input type="text" id="rsa_path1" name="rsa_path1" placeholder="products" maxlength="15">
                            <small>Max 15 characters</small>
                        </div>
                        <div style="flex: 1;">
                            <label for="rsa_path2">Path 2 (optional):</label>
                            <input type="text" id="rsa_path2" name="rsa_path2" placeholder="diaries" maxlength="15">
                            <small>Max 15 characters</small>
                        </div>
                    </div>
                </div>

                <!-- Step 6c: Sitelinks Form -->
                <div class="form-section hidden" id="step6c_sitelinks">
                    <h2>Sitelinks</h2>

                    <div class="form-group">
                        <label for="sitelinks_data">Sitelinks (one per line):</label>
                        <textarea id="sitelinks_data" name="sitelinks_data" rows="6" placeholder="Shop Diaries | https://example.com/diaries | Premium leather | Made in England&#10;Free Delivery | https://example.com/delivery | Next day shipping | On all orders"></textarea>
                        <small>Format: Text | URL | Description 1 | Description 2</small>
                        <small style="display: block; margin-top: 5px;">Text: max 25 chars, Descriptions: max 35 chars each</small>
                    </div>
                </div>

                <!-- Step 6d: Callouts Form -->
                <div class="form-section hidden" id="step6d_callouts">
                    <h2>Callouts</h2>

                    <div class="form-group">
                        <label for="callouts_data">Callouts (one per line):</label>
                        <textarea id="callouts_data" name="callouts_data" rows="6" placeholder="Free UK delivery&#10;Made in England&#10;Premium leather&#10;Personalisation available&#10;Next day shipping&#10;Gift wrapping"></textarea>
                        <small>Max 25 characters each, minimum 2 required</small>
                    </div>
                </div>

                <!-- Step 4b: New Asset Group Details (PMax) -->
                <div class="form-section hidden" id="step4b_assetgroup">
                    <h2>Step 4: Asset Group Details</h2>

                    <div class="form-group">
                        <label for="asset_group_name">Asset Group Name:</label>
                        <input type="text" id="asset_group_name" name="asset_group_name" placeholder="e.g., Christmas Gifting for Him">
                    </div>

                    <div class="form-group">
                        <label for="final_urls">Final URL:</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="url" id="final_urls" name="final_urls" placeholder="https://example.com/products" style="flex: 1;">
                            <button type="button" class="btn-secondary" id="generateAssetGroupBtn" style="min-width: 150px;">
                                ü§ñ Generate Assets
                            </button>
                        </div>
                        <small>Landing page URL for this asset group - AI will generate text assets</small>
                    </div>

                    <div class="form-group">
                        <label for="business_name">Business Name:</label>
                        <input type="text" id="business_name" name="business_name" placeholder="e.g., Smythson" maxlength="25">
                        <small>Max 25 characters</small>
                    </div>

                    <div class="form-group">
                        <label for="headlines">Headlines (one per line, 3-5 required):</label>
                        <textarea id="headlines" name="headlines" rows="5" placeholder="Luxury leather diaries&#10;Handcrafted in London&#10;Free UK delivery"></textarea>
                        <small>Enter 3-5 headlines, max 30 characters each</small>
                    </div>

                    <div class="form-group">
                        <label for="long_headlines">Long Headlines (one per line, 1-5 required):</label>
                        <textarea id="long_headlines" name="long_headlines" rows="3" placeholder="Shop our collection of premium leather diaries"></textarea>
                        <small>Enter 1-5 long headlines, max 90 characters each</small>
                    </div>

                    <div class="form-group">
                        <label for="descriptions">Descriptions (one per line, 2-5 required):</label>
                        <textarea id="descriptions" name="descriptions" rows="4" placeholder="Discover luxury leather gifts - perfect for the festive season&#10;Elegant leather gifts, expertly crafted"></textarea>
                        <small>Enter 2-5 descriptions, max 90 characters each</small>
                    </div>

                    <div class="alert alert-warning">
                        <strong>Note:</strong> Images and videos must be added manually via Google Ads UI after creation.
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="form-section" id="submitSection" style="display: none;">
                    <button type="submit" class="btn-primary" id="submitBtn">
                        Create (PAUSED State)
                    </button>
                </div>

            </form>

            <!-- Result Display -->
            <div id="result" class="result-container hidden">
                <h3>‚úÖ Creation Successful</h3>
                <div id="resultContent"></div>
                <button onclick="location.reload()" class="btn-secondary">Create Another</button>
            </div>

            <!-- Error Display -->
            <div id="error" class="error-container hidden">
                <h3>‚ùå Error</h3>
                <div id="errorContent"></div>
                <button onclick="location.reload()" class="btn-secondary">Try Again</button>
            </div>

        </div>

        <footer>
            <p>‚ö†Ô∏è All campaigns, ad groups, and asset groups are created in <strong>PAUSED</strong> state for safety.</p>
            <p>Review in Google Ads before enabling.</p>
        </footer>
    </div>

    <!-- Keyword Generation Modal -->
    <div id="keywordModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ü§ñ AI-Generated Keywords</h2>
                <button class="modal-close" onclick="closeKeywordModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="model-selector">
                    <label style="font-weight: 600; margin-bottom: 8px; display: block;">AI Model:</label>
                    <div style="display: flex; gap: 20px; margin-bottom: 16px;">
                        <label class="radio-label">
                            <input type="radio" name="keywordModel" value="claude-3-haiku-20240307" checked>
                            <span>Haiku (Fast & Economical)</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="keywordModel" value="claude-3-5-sonnet-20241022">
                            <span>Sonnet (Premium Quality)</span>
                        </label>
                    </div>
                </div>
                <div id="keywordLoading" class="modal-loading">
                    <div class="loading-spinner"></div>
                    <p>Analyzing landing page and generating high-converting keywords...</p>
                </div>
                <div id="keywordResults" class="hidden">
                    <div class="modal-stats">
                        <span id="keywordFilterStats"></span>
                        <span id="keywordCostStats" style="margin-left: 15px; color: var(--primary-color); font-weight: 600;"></span>
                    </div>
                    <div id="keywordList" class="asset-list"></div>
                </div>
            </div>
            <div class="modal-footer hidden" id="keywordFooter">
                <button class="btn-secondary" onclick="closeKeywordModal()">Cancel</button>
                <button class="btn-primary" onclick="useSelectedKeywords()">Use Selected (<span id="keywordCount">0</span>)</button>
            </div>
        </div>
    </div>

    <!-- Ad Copy Generation Modal (RSA) -->
    <div id="rsaModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ü§ñ AI-Generated Ad Copy</h2>
                <button class="modal-close" onclick="closeRsaModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="model-selector">
                    <label style="font-weight: 600; margin-bottom: 8px; display: block;">AI Model:</label>
                    <div style="display: flex; gap: 20px; margin-bottom: 16px;">
                        <label class="radio-label">
                            <input type="radio" name="rsaModel" value="claude-3-haiku-20240307" checked>
                            <span>Haiku (Fast & Economical)</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="rsaModel" value="claude-3-5-sonnet-20241022">
                            <span>Sonnet (Premium Quality)</span>
                        </label>
                    </div>
                </div>
                <div id="rsaLoading" class="modal-loading">
                    <div class="loading-spinner"></div>
                    <p>Analyzing landing page and generating professional ad copy...</p>
                </div>
                <div id="rsaResults" class="hidden">
                    <div class="modal-stats" style="margin-bottom: 16px;">
                        <span id="rsaCostStats" style="color: var(--primary-color); font-weight: 600;"></span>
                    </div>
                    <div class="asset-section">
                        <h3>Headlines (Max 30 chars)</h3>
                        <div id="rsaHeadlineList" class="asset-list"></div>
                    </div>
                    <div class="asset-section">
                        <h3>Descriptions (Max 90 chars)</h3>
                        <div id="rsaDescriptionList" class="asset-list"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer hidden" id="rsaFooter">
                <button class="btn-secondary" onclick="closeRsaModal()">Cancel</button>
                <button class="btn-primary" onclick="useSelectedRsa()">Use Selected</button>
            </div>
        </div>
    </div>

    <!-- Asset Group Generation Modal (PMax) -->
    <div id="assetGroupModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ü§ñ AI-Generated Asset Group Assets</h2>
                <button class="modal-close" onclick="closeAssetGroupModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="model-selector">
                    <label style="font-weight: 600; margin-bottom: 8px; display: block;">AI Model:</label>
                    <div style="display: flex; gap: 20px; margin-bottom: 16px;">
                        <label class="radio-label">
                            <input type="radio" name="assetGroupModel" value="claude-3-haiku-20240307" checked>
                            <span>Haiku (Fast & Economical)</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="assetGroupModel" value="claude-3-5-sonnet-20241022">
                            <span>Sonnet (Premium Quality)</span>
                        </label>
                    </div>
                </div>
                <div id="assetGroupLoading" class="modal-loading">
                    <div class="loading-spinner"></div>
                    <p>Analyzing landing page and generating asset group text...</p>
                </div>
                <div id="assetGroupResults" class="hidden">
                    <div class="modal-stats" style="margin-bottom: 16px;">
                        <span id="assetGroupCostStats" style="color: var(--primary-color); font-weight: 600;"></span>
                    </div>
                    <div class="asset-section">
                        <h3>Short Headlines (Max 30 chars, 3-5 needed)</h3>
                        <div id="shortHeadlineList" class="asset-list"></div>
                    </div>
                    <div class="asset-section">
                        <h3>Long Headlines (Max 90 chars, 1-5 needed)</h3>
                        <div id="longHeadlineList" class="asset-list"></div>
                    </div>
                    <div class="asset-section">
                        <h3>Descriptions (Max 90 chars, 2-5 needed)</h3>
                        <div id="assetGroupDescriptionList" class="asset-list"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer hidden" id="assetGroupFooter">
                <button class="btn-secondary" onclick="closeAssetGroupModal()">Cancel</button>
                <button class="btn-primary" onclick="useSelectedAssetGroup()">Use Selected</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ai-generator.js') }}"></script>
</body>
</html>

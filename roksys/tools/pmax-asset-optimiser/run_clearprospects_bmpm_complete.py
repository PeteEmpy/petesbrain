#!/usr/bin/env python3
"""
Complete Clear Prospects BMPM PMAX Asset Optimizer Pipeline
Step 1: Load API data (embedded from MCP call)
Step 2: Convert to CSV
Step 3: Analyze with customer-specific benchmarks
Step 4: Identify underperformers for replacement
"""

import json
import sys
sys.path.insert(0, '.')

from convert_brightminds_api_to_csv import convert_api_to_csv
from analyse_api_export import analyse_bright_minds_api

# Clear Prospects BMPM API data (42 text assets from Google Ads API)
# Customer ID: 6281395727
# Campaign: CPL | BMPM | P Max Shopping (21173762063)
# Date Range: Last 30 days
# Note: BMPM is in crisis with 78% actual ROAS vs 70% target

api_results_json = '''[{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"82","conversionsValue":20.56,"conversions":2,"costMicros":"129954553","ctr":0.10148514851485149,"impressions":"808"},"asset":{"resourceName":"customers/6281395727/assets/259790624547","type":"TEXT","textAsset":{"text":"Why settle for imports? Get quality UK made promotional items delivered fast."},"id":"259790624547"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~259790624547~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"72","conversionsValue":6.83,"conversions":1,"costMicros":"126294247","ctr":0.10027855153203342,"impressions":"718"},"asset":{"resourceName":"customers/6281395727/assets/133226448616","type":"TEXT","textAsset":{"text":"25 Years Experience Manufacturing Quality Promotional Merchandise In The UK"},"id":"133226448616"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~133226448616~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"51","conversionsValue":20.56,"conversions":2,"costMicros":"115223213","ctr":0.10515463917525773,"impressions":"485"},"asset":{"resourceName":"customers/6281395727/assets/136431691071","type":"TEXT","textAsset":{"text":"No Minimum Order Quantity"},"id":"136431691071"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~136431691071~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"25","conversionsValue":13.73,"conversions":1,"costMicros":"49274095","ctr":0.062034739454094295,"impressions":"403"},"asset":{"resourceName":"customers/6281395727/assets/134252152263","type":"TEXT","textAsset":{"text":"UK Made & Printed"},"id":"134252152263"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~134252152263~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"17","conversionsValue":0,"conversions":0,"costMicros":"10568735","ctr":0.05448717948717949,"impressions":"312"},"asset":{"resourceName":"customers/6281395727/assets/266023589465","type":"TEXT","textAsset":{"text":"Stand out at events with premium quality printed tablecloths & runners made in Lancashire."},"id":"266023589465"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~266023589465~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"38","conversionsValue":6.83,"conversions":1,"costMicros":"63446757","ctr":0.1292517006802721,"impressions":"294"},"asset":{"resourceName":"customers/6281395727/assets/259619902731","type":"TEXT","textAsset":{"text":"No Setup Fee - No MOQ"},"id":"259619902731"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~259619902731~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"11","conversionsValue":0,"conversions":0,"costMicros":"24217028","ctr":0.039285714285714285,"impressions":"280"},"asset":{"resourceName":"customers/6281395727/assets/138818765381","type":"TEXT","textAsset":{"text":"Branded Promotional Products"},"id":"138818765381"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~138818765381~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"11","conversionsValue":0,"conversions":0,"costMicros":"15430000","ctr":0.03985507246376811,"impressions":"276"},"asset":{"resourceName":"customers/6281395727/assets/132268143355","type":"TEXT","textAsset":{"text":"British Made Promotional Merchandise"},"id":"132268143355"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6608003513","name":"Shopping - All","id":"6608003513"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6608003513~132268143355~LONG_HEADLINE","fieldType":"LONG_HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"11","conversionsValue":0,"conversions":0,"costMicros":"15430000","ctr":0.03985507246376811,"impressions":"276"},"asset":{"resourceName":"customers/6281395727/assets/301637268033","type":"TEXT","textAsset":{"text":"Shop UK Made Promotional Products"},"id":"301637268033"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6608003513","name":"Shopping - All","id":"6608003513"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6608003513~301637268033~LONG_HEADLINE","fieldType":"LONG_HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"28","conversionsValue":6.83,"conversions":1,"costMicros":"36205032","ctr":0.10980392156862745,"impressions":"255"},"asset":{"resourceName":"customers/6281395727/assets/169077470457","type":"TEXT","textAsset":{"text":"Made To Order - No Minimum Qty"},"id":"169077470457"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~169077470457~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"0","conversionsValue":0,"conversions":0,"costMicros":"4700048","ctr":0,"impressions":"237"},"asset":{"resourceName":"customers/6281395727/assets/266119577058","type":"TEXT","textAsset":{"text":"Your brand deserves better than a birthday party tablecloth!"},"id":"266119577058"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~266119577058~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"1","conversionsValue":0,"conversions":0,"costMicros":"825492","ctr":0.004273504273504274,"impressions":"234"},"asset":{"resourceName":"customers/6281395727/assets/278942552463","type":"TEXT","textAsset":{"text":"UK-made headrest covers with full-colour, edge-to-edge print. Get trade pricing now."},"id":"278942552463"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6496192660","name":"Headrest Covers","id":"6496192660"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6496192660~278942552463~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"23","conversionsValue":0,"conversions":0,"costMicros":"38713027","ctr":0.10222222222222223,"impressions":"225"},"asset":{"resourceName":"customers/6281395727/assets/136390013017","type":"TEXT","textAsset":{"text":"Made To Order, No Minimum"},"id":"136390013017"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~136390013017~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"12","conversionsValue":6.83,"conversions":1,"costMicros":"24451050","ctr":0.053811659192825115,"impressions":"223"},"asset":{"resourceName":"customers/6281395727/assets/133226448595","type":"TEXT","textAsset":{"text":"Low Price - High Quality"},"id":"133226448595"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~133226448595~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"5","conversionsValue":0,"conversions":0,"costMicros":"8000890","ctr":0.02262443438914027,"impressions":"221"},"asset":{"resourceName":"customers/6281395727/assets/266119577049","type":"TEXT","textAsset":{"text":"Pantone matched colours ensure your brand looks perfect every time."},"id":"266119577049"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~266119577049~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"12","conversionsValue":0,"conversions":0,"costMicros":"6045256","ctr":0.05429864253393665,"impressions":"221"},"asset":{"resourceName":"customers/6281395727/assets/266119577052","type":"TEXT","textAsset":{"text":"UK manufactured custom tablecloths perfect for exhibitions & trade shows."},"id":"266119577052"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~266119577052~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"24","conversionsValue":0,"conversions":0,"costMicros":"21397923","ctr":0.1188118811881188,"impressions":"202"},"asset":{"resourceName":"customers/6281395727/assets/138818765390","type":"TEXT","textAsset":{"text":"Fast Turnaround & Low Price, High Quality Promotional Products - View Now"},"id":"138818765390"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~138818765390~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"20","conversionsValue":0,"conversions":0,"costMicros":"37834594","ctr":0.10416666666666667,"impressions":"192"},"asset":{"resourceName":"customers/6281395727/assets/266122511619","type":"TEXT","textAsset":{"text":"No minimum orders or setup fees - perfect for small events or large festival staffing."},"id":"266122511619"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597175907","name":"Sashes","id":"6597175907"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597175907~266122511619~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"1","conversionsValue":0,"conversions":0,"costMicros":"331077","ctr":0.0058823529411764705,"impressions":"170"},"asset":{"resourceName":"customers/6281395727/assets/259735616572","type":"TEXT","textAsset":{"text":"Trade Price Headrest Covers"},"id":"259735616572"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6496192660","name":"Headrest Covers","id":"6496192660"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6496192660~259735616572~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"4","conversionsValue":0,"conversions":0,"costMicros":"8441875","ctr":0.024096385542168676,"impressions":"166"},"asset":{"resourceName":"customers/6281395727/assets/133226448589","type":"TEXT","textAsset":{"text":"Full Colour Dye-Sub Printing"},"id":"133226448589"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~133226448589~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"0","conversionsValue":0,"conversions":0,"costMicros":"513949","ctr":0,"impressions":"158"},"asset":{"resourceName":"customers/6281395727/assets/133226448589","type":"TEXT","textAsset":{"text":"Full Colour Dye-Sub Printing"},"id":"133226448589"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6496192660","name":"Headrest Covers","id":"6496192660"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6496192660~133226448589~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"6","conversionsValue":0,"conversions":0,"costMicros":"2275694","ctr":0.03870967741935484,"impressions":"155"},"asset":{"resourceName":"customers/6281395727/assets/133381439070","type":"TEXT","textAsset":{"text":"Fast Turnaround & Low Price, High Quality Promotional Cushions - View Now"},"id":"133381439070"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6589051884","name":"Promo Cushions","id":"6589051884"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6589051884~133381439070~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"2","conversionsValue":0,"conversions":0,"costMicros":"377234","ctr":0.013157894736842105,"impressions":"152"},"asset":{"resourceName":"customers/6281395727/assets/278942552457","type":"TEXT","textAsset":{"text":"No MOQ and rapid UK production from Lancashire. Scale to 10,000+ when you need to."},"id":"278942552457"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6496192660","name":"Headrest Covers","id":"6496192660"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6496192660~278942552457~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"6","conversionsValue":0,"conversions":0,"costMicros":"7141951","ctr":0.04081632653061224,"impressions":"147"},"asset":{"resourceName":"customers/6281395727/assets/259737487633","type":"TEXT","textAsset":{"text":"Get your logo printed on quality cushions. Fast turnaround for urgent events."},"id":"259737487633"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6589051884","name":"Promo Cushions","id":"6589051884"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6589051884~259737487633~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"14","conversionsValue":0,"conversions":0,"costMicros":"17324231","ctr":0.09655172413793103,"impressions":"145"},"asset":{"resourceName":"customers/6281395727/assets/136431691089","type":"TEXT","textAsset":{"text":"Eye-Catching Material Bunting: Perfect for Trade Shows & Events. UK Hand-Cut & Sewn"},"id":"136431691089"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6497409383","name":"Promo Bunting","id":"6497409383"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6497409383~136431691089~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"2","conversionsValue":0,"conversions":0,"costMicros":"5323462","ctr":0.013888888888888888,"impressions":"144"},"asset":{"resourceName":"customers/6281395727/assets/265767132134","type":"TEXT","textAsset":{"text":"No Minimum Order Required"},"id":"265767132134"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~265767132134~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"5","conversionsValue":0,"conversions":0,"costMicros":"2241302","ctr":0.034722222222222224,"impressions":"144"},"asset":{"resourceName":"customers/6281395727/assets/266119577013","type":"TEXT","textAsset":{"text":"UK Made Custom Tablecloths"},"id":"266119577013"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~266119577013~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"6","conversionsValue":0,"conversions":0,"costMicros":"4030177","ctr":0.041666666666666664,"impressions":"144"},"asset":{"resourceName":"customers/6281395727/assets/266119577055","type":"TEXT","textAsset":{"text":"Transform any table into powerful brand advertising space in minutes."},"id":"266119577055"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~266119577055~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"2","conversionsValue":0,"conversions":0,"costMicros":"3649712","ctr":0.014285714285714285,"impressions":"140"},"asset":{"resourceName":"customers/6281395727/assets/266119577022","type":"TEXT","textAsset":{"text":"Exhibition Ready Tables"},"id":"266119577022"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~266119577022~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"7","conversionsValue":0,"conversions":0,"costMicros":"3554197","ctr":0.051094890510948905,"impressions":"137"},"asset":{"resourceName":"customers/6281395727/assets/133226448613","type":"TEXT","textAsset":{"text":"Eye-Catching Cushions: Perfect for Trade Shows & Events"},"id":"133226448613"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6589051884","name":"Promo Cushions","id":"6589051884"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6589051884~133226448613~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"18","conversionsValue":0,"conversions":0,"costMicros":"23281671","ctr":0.13333333333333333,"impressions":"135"},"asset":{"resourceName":"customers/6281395727/assets/132268143346","type":"TEXT","textAsset":{"text":"Promotional Products And Branded Merchandise"},"id":"132268143346"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~132268143346~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"12","conversionsValue":0,"conversions":0,"costMicros":"17499277","ctr":0.09022556390977443,"impressions":"133"},"asset":{"resourceName":"customers/6281395727/assets/138818765387","type":"TEXT","textAsset":{"text":"Manufactured In The UK"},"id":"138818765387"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~138818765387~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"9","conversionsValue":0,"conversions":0,"costMicros":"6661232","ctr":0.06923076923076923,"impressions":"130"},"asset":{"resourceName":"customers/6281395727/assets/138818765390","type":"TEXT","textAsset":{"text":"Fast Turnaround & Low Price, High Quality Promotional Products - View Now"},"id":"138818765390"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6551894018","name":"Generic Remarketing","id":"6551894018"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6551894018~138818765390~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"4","conversionsValue":0,"conversions":0,"costMicros":"2504817","ctr":0.03076923076923077,"impressions":"130"},"asset":{"resourceName":"customers/6281395727/assets/278942552460","type":"TEXT","textAsset":{"text":"Make seats less boring‚Äîmake them yours. Your logo, bold colours, and comfy fabric fit."},"id":"278942552460"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6496192660","name":"Headrest Covers","id":"6496192660"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6496192660~278942552460~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"5","conversionsValue":0,"conversions":0,"costMicros":"6652591","ctr":0.03875968992248062,"impressions":"129"},"asset":{"resourceName":"customers/6281395727/assets/133226448616","type":"TEXT","textAsset":{"text":"25 Years Experience Manufacturing Quality Promotional Merchandise In The UK"},"id":"133226448616"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6589051884","name":"Promo Cushions","id":"6589051884"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6589051884~133226448616~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"5","conversionsValue":0,"conversions":0,"costMicros":"3560581","ctr":0.03875968992248062,"impressions":"129"},"asset":{"resourceName":"customers/6281395727/assets/266119577043","type":"TEXT","textAsset":{"text":"Lancashire Made Quality"},"id":"266119577043"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597272947","name":"Tablecloths","id":"6597272947"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597272947~266119577043~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"11","conversionsValue":0,"conversions":0,"costMicros":"16244049","ctr":0.09401709401709402,"impressions":"117"},"asset":{"resourceName":"customers/6281395727/assets/138829650469","type":"TEXT","textAsset":{"text":"Promotional Products from BMPM"},"id":"138829650469"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6498732837","name":"Generic","id":"6498732837"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6498732837~138829650469~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"8","conversionsValue":0,"conversions":0,"costMicros":"6668892","ctr":0.07272727272727272,"impressions":"110"},"asset":{"resourceName":"customers/6281395727/assets/259790624547","type":"TEXT","textAsset":{"text":"Why settle for imports? Get quality UK made promotional items delivered fast."},"id":"259790624547"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6551894018","name":"Generic Remarketing","id":"6551894018"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6551894018~259790624547~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"6","conversionsValue":0,"conversions":0,"costMicros":"10108740","ctr":0.056074766355140186,"impressions":"107"},"asset":{"resourceName":"customers/6281395727/assets/136431691059","type":"TEXT","textAsset":{"text":"UK Made & Printed Bunting"},"id":"136431691059"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6497409383","name":"Promo Bunting","id":"6497409383"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6497409383~136431691059~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"5","conversionsValue":0,"conversions":0,"costMicros":"4427091","ctr":0.04716981132075472,"impressions":"106"},"asset":{"resourceName":"customers/6281395727/assets/259790624547","type":"TEXT","textAsset":{"text":"Why settle for imports? Get quality UK made promotional items delivered fast."},"id":"259790624547"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597127768","name":"Tea Towels","id":"6597127768"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597127768~259790624547~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"2","conversionsValue":0,"conversions":0,"costMicros":"4869668","ctr":0.019230769230769232,"impressions":"104"},"asset":{"resourceName":"customers/6281395727/assets/259772854233","type":"TEXT","textAsset":{"text":"Wholesale headrest covers - perfect for conferences, events & venues. Get quote now!"},"id":"259772854233"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6496192660","name":"Headrest Covers","id":"6496192660"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6496192660~259772854233~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21173762063","name":"CPL | BMPM | P Max Shopping 8/9 50 6/10 70 No target 21/10 70 11/11","id":"21173762063"},"metrics":{"clicks":"7","conversionsValue":0,"conversions":0,"costMicros":"24341413","ctr":0.06862745098039216,"impressions":"102"},"asset":{"resourceName":"customers/6281395727/assets/265767132134","type":"TEXT","textAsset":{"text":"No Minimum Order Required"},"id":"265767132134"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6597175907","name":"Sashes","id":"6597175907"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6597175907~265767132134~HEADLINE","fieldType":"HEADLINE"}}]'''

api_results = json.loads(api_results_json)

print("=" * 80)
print("CLEAR PROSPECTS BMPM - PMAX ASSET OPTIMIZER")
print("=" * 80)
print(f"Customer ID: 6281395727")
print(f"Campaign: CPL | BMPM | P Max Shopping (21173762063)")
print(f"Campaign Status: CRISIS - 78% actual ROAS vs 70% target")
print(f"Assets Retrieved: {len(api_results)}")
print("=" * 80)
print()

# Step 2: Convert to CSV
print("STEP 1: Converting API data to CSV...")
csv_output = "output/clearprospects-bmpm-asset-performance-api-2025-11-27.csv"
convert_api_to_csv(api_results, csv_output)
print(f"‚úÖ CSV created: {csv_output}")
print()

# Step 3: Analyze with customer-specific benchmarks
print("STEP 2: Analyzing with customer-specific benchmarks...")
classifications, benchmarks = analyse_bright_minds_api(api_results)
print()

# Step 4: Report results
print("=" * 80)
print("ANALYSIS RESULTS")
print("=" * 80)
print()
print(f"Campaign Benchmarks (BMPM-specific):")
print(f"  Average CTR: {benchmarks['avg_ctr']:.2%}")
print(f"  Average Conv Rate: {benchmarks['avg_conv_rate']:.2%}")
print(f"  Average CPA: ¬£{benchmarks['avg_cpa']:.2f}")
print()
print("Asset Performance Classification:")
print(f"  ‚úÖ KEEP (Winners): {len(classifications['KEEP'])} assets")
print(f"  üî¥ REPLACE HIGH: {len(classifications['REPLACE']['HIGH'])} assets")
print(f"  üü° REPLACE MEDIUM: {len(classifications['REPLACE']['MEDIUM'])} assets")
print(f"  üü† REPLACE LOW: {len(classifications['REPLACE']['LOW'])} assets")
print(f"  üëÄ MONITOR: {len(classifications['MONITOR'])} assets")
print(f"  ‚è≥ TOO EARLY: {len(classifications['TOO_EARLY'])} assets")
print()

total_replace = (len(classifications['REPLACE']['HIGH']) + 
                 len(classifications['REPLACE']['MEDIUM']) + 
                 len(classifications['REPLACE']['LOW']))

print("=" * 80)
print("PIPELINE STATUS")
print("=" * 80)
print()

if total_replace > 0:
    print(f"‚úÖ {total_replace} underperforming assets identified for replacement!")
    print()
    print("Next steps:")
    print("  1. Generate AI-powered replacement text")
    print("  2. Upload to Google Sheets for review")
    print("  3. Implement approved replacements")
else:
    print("‚ùå No underperformers found - all assets performing well")
    print("   This is good news for performance but doesn't help with testing!")

print()
print("=" * 80)
print("COMPLETE")
print("=" * 80)

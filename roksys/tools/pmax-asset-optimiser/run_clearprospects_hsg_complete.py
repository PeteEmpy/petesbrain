#!/usr/bin/env python3
"""
Complete Clear Prospects HSG PMAX Asset Optimizer Pipeline
"""

import json
import sys
sys.path.insert(0, '.')

from convert_brightminds_api_to_csv import convert_api_to_csv
from analyse_api_export import analyse_bright_minds_api

# Clear Prospects HSG API data (29 text assets)
# Customer ID: 6281395727
# Campaign: CPL | HSG | P Max | All | H&S (21730574366)
# Date Range: Last 30 days

api_results = [{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"480","conversionsValue":503.124745947,"conversions":51.752674,"costMicros":"415480280","ctr":0.0873203565581226,"impressions":"5497"},"asset":{"resourceName":"customers/6281395727/assets/254225619162","type":"TEXT","textAsset":{"text":"Send Their Photo & We'll Provide The Fun For Any Party, Stag Dos, Hen Do's or Birthday"},"id":"254225619162"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~254225619162~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"423","conversionsValue":483.248082287,"conversions":48.419341,"costMicros":"380398346","ctr":0.08894028595458368,"impressions":"4756"},"asset":{"resourceName":"customers/6281395727/assets/90062082010","type":"TEXT","textAsset":{"text":"These Masks Are Great For Parties, Stag Dos, Hen Dos, BBQs Or Any Fun Get Together"},"id":"90062082010"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~90062082010~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"452","conversionsValue":507.311408927,"conversions":52.41934,"costMicros":"409362119","ctr":0.10703291498934407,"impressions":"4223"},"asset":{"resourceName":"customers/6281395727/assets/263047978792","type":"TEXT","textAsset":{"text":"Order By 2pm For Next Day Del"},"id":"263047978792"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~263047978792~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"235","conversionsValue":79.063339612,"conversions":10.333334,"costMicros":"227429795","ctr":0.10257529463116544,"impressions":"2291"},"asset":{"resourceName":"customers/6281395727/assets/38943283020","type":"TEXT","textAsset":{"text":"HappySnapGifts | Personalised Photo Gifts"},"id":"38943283020"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6604287789","name":"Shopping - H&S","id":"6604287789"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6604287789~38943283020~LONG_HEADLINE","fieldType":"LONG_HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"235","conversionsValue":79.063339612,"conversions":10.333334,"costMicros":"227429795","ctr":0.10257529463116544,"impressions":"2291"},"asset":{"resourceName":"customers/6281395727/assets/43866529774","type":"TEXT","textAsset":{"text":"HappySnapGifts® Personalised Gifts"},"id":"43866529774"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6604287789","name":"Shopping - H&S","id":"6604287789"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6604287789~43866529774~LONG_HEADLINE","fieldType":"LONG_HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"193","conversionsValue":241.501613327,"conversions":23.364362,"costMicros":"178038909","ctr":0.09287776708373437,"impressions":"2078"},"asset":{"resourceName":"customers/6281395727/assets/243908808377","type":"TEXT","textAsset":{"text":"Their Photo On A Mask"},"id":"243908808377"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~243908808377~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"190","conversionsValue":151.057254666,"conversions":16.511868,"costMicros":"171265192","ctr":0.09562154001006543,"impressions":"1987"},"asset":{"resourceName":"customers/6281395727/assets/90062082001","type":"TEXT","textAsset":{"text":"For Parties, Stag Dos, Hen Dos"},"id":"90062082001"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~90062082001~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"116","conversionsValue":144.871896671,"conversions":14.913322,"costMicros":"94995148","ctr":0.0782198246797033,"impressions":"1483"},"asset":{"resourceName":"customers/6281395727/assets/243908808374","type":"TEXT","textAsset":{"text":"Upload A Photo, We Do The Rest"},"id":"243908808374"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~243908808374~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"171","conversionsValue":218.83752744,"conversions":21.497734,"costMicros":"159099505","ctr":0.12,"impressions":"1425"},"asset":{"resourceName":"customers/6281395727/assets/98211591033","type":"TEXT","textAsset":{"text":"Personalised Photo Face Masks"},"id":"98211591033"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~98211591033~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"107","conversionsValue":155.458713765,"conversions":14.927456,"costMicros":"114210914","ctr":0.09336823734729494,"impressions":"1146"},"asset":{"resourceName":"customers/6281395727/assets/119331750040","type":"TEXT","textAsset":{"text":"Big Head Party Face Mask Kit"},"id":"119331750040"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~119331750040~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"49","conversionsValue":30.10680384,"conversions":4.492933,"costMicros":"37892307","ctr":0.07492354740061162,"impressions":"654"},"asset":{"resourceName":"customers/6281395727/assets/238650613076","type":"TEXT","textAsset":{"text":"DIY or Ready-Made Face Masks"},"id":"238650613076"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~238650613076~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"64","conversionsValue":28.117395526,"conversions":3.338135,"costMicros":"47946954","ctr":0.10256410256410256,"impressions":"624"},"asset":{"resourceName":"customers/6281395727/assets/242647824919","type":"TEXT","textAsset":{"text":"Cardboard Cut Out Photo Mask"},"id":"242647824919"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~242647824919~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"102","conversionsValue":119.02095684,"conversions":11.418123,"costMicros":"110730551","ctr":0.1837837837837838,"impressions":"555"},"asset":{"resourceName":"customers/6281395727/assets/90062082004","type":"TEXT","textAsset":{"text":"These Masks Are A Great Who's Who For Parties"},"id":"90062082004"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~90062082004~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"74","conversionsValue":61.345,"conversions":5.5,"costMicros":"89089493","ctr":0.15195071868583163,"impressions":"487"},"asset":{"resourceName":"customers/6281395727/assets/90062082007","type":"TEXT","textAsset":{"text":"Who's The Party Person, Confuse The Heck Out Of Everyone With These Great Masks"},"id":"90062082007"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~90062082007~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"15","conversionsValue":5.27,"conversions":1,"costMicros":"6378297","ctr":0.03464203233256351,"impressions":"433"},"asset":{"resourceName":"customers/6281395727/assets/125176246572","type":"TEXT","textAsset":{"text":"For Stags, Hens Or Surprises"},"id":"125176246572"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~125176246572~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"44","conversionsValue":41.216742815,"conversions":3.803521,"costMicros":"37215268","ctr":0.11764705882352941,"impressions":"374"},"asset":{"resourceName":"customers/6281395727/assets/119331750037","type":"TEXT","textAsset":{"text":"Printed Photo Face Masks"},"id":"119331750037"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~119331750037~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"33","conversionsValue":12.39180384,"conversions":0.992933,"costMicros":"38212518","ctr":0.1,"impressions":"330"},"asset":{"resourceName":"customers/6281395727/assets/254225619156","type":"TEXT","textAsset":{"text":"UK Made Party Fun"},"id":"254225619156"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~254225619156~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"9","conversionsValue":6.03,"conversions":1,"costMicros":"7452872","ctr":0.038135593220338986,"impressions":"236"},"asset":{"resourceName":"customers/6281395727/assets/254225619153","type":"TEXT","textAsset":{"text":"Quality Photo Face Masks"},"id":"254225619153"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~254225619153~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"7","conversionsValue":0,"conversions":0,"costMicros":"5545439","ctr":0.03626943005181347,"impressions":"193"},"asset":{"resourceName":"customers/6281395727/assets/141967275529","type":"TEXT","textAsset":{"text":"Personalised Gift Accessories"},"id":"141967275529"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~141967275529~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"11","conversionsValue":0,"conversions":0,"costMicros":"11271254","ctr":0.0738255033557047,"impressions":"149"},"asset":{"resourceName":"customers/6281395727/assets/90062082016","type":"TEXT","textAsset":{"text":"These Fun Photo Masks Have Your Photo Printed Onto Card And Contain All Fastenings"},"id":"90062082016"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~90062082016~DESCRIPTION","fieldType":"DESCRIPTION"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"4","conversionsValue":0,"conversions":0,"costMicros":"2482324","ctr":0.038834951456310676,"impressions":"103"},"asset":{"resourceName":"customers/6281395727/assets/255485761937","type":"TEXT","textAsset":{"text":"Shop HappySnapGifts"},"id":"255485761937"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~255485761937~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"4","conversionsValue":0,"conversions":0,"costMicros":"4764931","ctr":0.05194805194805195,"impressions":"77"},"asset":{"resourceName":"customers/6281395727/assets/309356750690","type":"TEXT","textAsset":{"text":"Buy party masks and gift bags"},"id":"309356750690"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~309356750690~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"1","conversionsValue":0,"conversions":0,"costMicros":"200524","ctr":0.014925373134328358,"impressions":"67"},"asset":{"resourceName":"customers/6281395727/assets/90062082013","type":"TEXT","textAsset":{"text":"Send Your Photo & We'll Print It Onto Card, Cut Out The Eye Holes & Send The Fastenings"},"id":"90062082013"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~90062082013~LONG_HEADLINE","fieldType":"LONG_HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"0","conversionsValue":0,"conversions":0,"costMicros":"184147","ctr":0,"impressions":"59"},"asset":{"resourceName":"customers/6281395727/assets/90062082007","type":"TEXT","textAsset":{"text":"Who's The Party Person, Confuse The Heck Out Of Everyone With These Great Masks"},"id":"90062082007"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~90062082007~LONG_HEADLINE","fieldType":"LONG_HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"0","conversionsValue":0,"conversions":0,"costMicros":"193603","ctr":0,"impressions":"58"},"asset":{"resourceName":"customers/6281395727/assets/254225619162","type":"TEXT","textAsset":{"text":"Send Their Photo & We'll Provide The Fun For Any Party, Stag Dos, Hen Do's or Birthday"},"id":"254225619162"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~254225619162~LONG_HEADLINE","fieldType":"LONG_HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"0","conversionsValue":0,"conversions":0,"costMicros":"201175","ctr":0,"impressions":"57"},"asset":{"resourceName":"customers/6281395727/assets/90062082016","type":"TEXT","textAsset":{"text":"These Fun Photo Masks Have Your Photo Printed Onto Card And Contain All Fastenings"},"id":"90062082016"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6518511892","name":"Photo Face Masks H&S","id":"6518511892"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6518511892~90062082016~LONG_HEADLINE","fieldType":"LONG_HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"0","conversionsValue":0,"conversions":0,"costMicros":"0","ctr":0,"impressions":"29"},"asset":{"resourceName":"customers/6281395727/assets/220331945187","type":"TEXT","textAsset":{"text":"Shop Photo Gifts"},"id":"220331945187"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6604287789","name":"Shopping - H&S","id":"6604287789"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6604287789~220331945187~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"0","conversionsValue":0,"conversions":0,"costMicros":"0","ctr":0,"impressions":"4"},"asset":{"resourceName":"customers/6281395727/assets/220330740484","type":"TEXT","textAsset":{"text":"Buy Personalised Photo Gifts"},"id":"220330740484"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6604287789","name":"Shopping - H&S","id":"6604287789"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6604287789~220330740484~HEADLINE","fieldType":"HEADLINE"}},{"campaign":{"resourceName":"customers/6281395727/campaigns/21730574366","name":"CPL | HSG | P Max | All | H&S 120 130 8/9 120 9/9 130 15/9 120 4/10","id":"21730574366"},"metrics":{"clicks":"0","conversionsValue":0,"conversions":0,"costMicros":"0","ctr":0,"impressions":"1"},"asset":{"resourceName":"customers/6281395727/assets/308427958809","type":"TEXT","textAsset":{"text":"Practical gift ideas"},"id":"308427958809"},"assetGroup":{"resourceName":"customers/6281395727/assetGroups/6604287789","name":"Shopping - H&S","id":"6604287789"},"assetGroupAsset":{"resourceName":"customers/6281395727/assetGroupAssets/6604287789~308427958809~HEADLINE","fieldType":"HEADLINE"}}]

# Pipeline execution
print("=" * 80)
print("CLEAR PROSPECTS HSG - PMAX ASSET OPTIMIZER")
print("=" * 80)
print()
print(f"✅ Step 1: API Export (29 assets loaded)")
print()

# Step 2: Convert to CSV
print("⏳ Step 2: Converting to CSV...")
csv_output = "output/clearprospects-hsg-asset-performance-api-2025-11-27.csv"
convert_api_to_csv(api_results, csv_output)
print()

# Step 3: Analyze with customer-specific benchmarks
print("⏳ Step 3: Analyzing with customer-specific benchmarks...")
classifications, benchmarks = analyse_bright_minds_api(api_results)
print()

print("=" * 80)
print("PIPELINE COMPLETE")
print("=" * 80)
print()
print("Next steps:")
if classifications['REPLACE']['HIGH'] or classifications['REPLACE']['MEDIUM']:
    print(f"✅ Ready for replacement text generation!")
    print(f"   HIGH priority: {len(classifications['REPLACE']['HIGH'])} assets")
    print(f"   MEDIUM priority: {len(classifications['REPLACE']['MEDIUM'])} assets")
    print()
    print("Run: python3 generate_replacement_text.py --customer-id 6281395727 --csv output/clearprospects-hsg-asset-performance-api-2025-11-27.csv")
else:
    print("❌ No underperformers found - all assets performing well")
